name: 'Saplings - Media'
description: 'Configures media best practices for modern Drupal.'
type: 'Site'
recipes:
  - core/recipes/audio_media_type
  - core/recipes/document_media_type
  - core/recipes/image_media_type
  - core/recipes/local_video_media_type
  - core/recipes/remote_video_media_type
  - imagemagick-configuration
install:
  - easy_responsive_images
  - entity_browser
  - entity_browser_entity_form
  - focal_point
  - inline_entity_form
  - lite_youtube_embed
  - media_entity_browser
  - media_entity_download
  - media_file_delete
  - media_library_edit
  - views
config:
  import:
    focal_point: '*'
  actions:
    # Set all media image fields to use focal point.
    core.entity_form_display.media.image.*:
      setComponent:
        name: field_media_image
        options:
          type: image_focal_point
          weight: 1
          region: content
          settings:
            progress_indicator: throbber
            preview_image_style: media_library
            preview_link: true
            offsets: '50,50'
    # Set the Remote video embed to use the lite widget.
    core.entity_view_display.media.remote_video.default:
      setComponent:
        name: field_media_oembed_video
        options:
          type: lite_youtube_embed
          label: hidden
          settings:
            max_width: 0
            max_height: 0
          third_party_settings: {  }
          weight: 0
          region: content
    # Delete the file when you delete a media entity.
    media_file_delete.settings:
      simple_config_update:
        delete_file_default: true
    # Core's Local Video recipe imports this. Lets hide.
    views.view.files:
      ensure_exists:
        id: views.view.files
        # Uncomment when #3303127 is merged.
        # set:
        #   key: status
        #   value: false
    # Lets add Media Entity Browsers if they don't exist.
    # The module does not work with Gin, so we will add like this.
    entity_browser.browser.media_entity_browser:
      ensure_exists:
        name: media_entity_browser
        label: 'Media Entity Browser'
        display: iframe
        display_configuration:
          width: '1070'
          height: '500'
          link_text: 'Select media'
          auto_open: true
        selection_display: no_display
        selection_display_configuration: {  }
        widget_selector: tabs
        widget_selector_configuration: {  }
        widgets:
          6586703a-6976-4124-8a49-cbb07ceaa3b1:
            settings:
              view: media_entity_browser
              view_display: media_browser_all
              submit_text: 'Select media'
              auto_select: false
            uuid: 6586703a-6976-4124-8a49-cbb07ceaa3b1
            weight: -9
            label: 'Choose existing media'
            id: view
          ecb3940b-e53b-4bc5-acb5-930d8780ea2f:
            settings:
              entity_type: media
              bundle: image
              form_mode: default
              submit_text: 'Save image'
            uuid: ecb3940b-e53b-4bc5-acb5-930d8780ea2f
            weight: -10
            label: 'Upload new image'
            id: entity_form
    entity_browser.browser.media_entity_browser_modal:
      ensure_exists:
        name: media_entity_browser_modal
        label: 'Media Entity Browser (Modal)'
        display: modal
        display_configuration:
          width: '1070'
          height: '500'
          link_text: 'Select media'
          auto_open: true
        selection_display: no_display
        selection_display_configuration: {  }
        widget_selector: tabs
        widget_selector_configuration: {  }
        widgets:
          fc729026-c85f-4561-acd5-38d4082b69fb:
            settings:
              view: media_entity_browser
              view_display: media_browser_all
              submit_text: 'Select media'
              auto_select: false
            uuid: fc729026-c85f-4561-acd5-38d4082b69fb
            weight: -9
            label: 'Choose existing media'
            id: view
          9769d4e4-1f9c-4313-8b01-fe8cff8aa5a1:
            settings:
              entity_type: media
              bundle: image
              form_mode: default
              submit_text: 'Save image'
            uuid: 9769d4e4-1f9c-4313-8b01-fe8cff8aa5a1
            weight: -10
            label: 'Upload new image'
            id: entity_form
    views.view.media_entity_browser:
      ensure_exists:
        id: media_entity_browser
        label: 'Media Browser'
        module: views
        description: ''
        tag: ''
        base_table: media_field_data
        base_field: mid
        core: 8.x
        display:
          default:
            display_plugin: default
            id: default
            display_title: Master
            position: 0
            display_options:
              access:
                type: perm
                options:
                  perm: 'view media'
              cache:
                type: tag
                options: {  }
              query:
                type: views_query
                options:
                  disable_sql_rewrite: false
                  distinct: false
                  replica: false
                  query_comment: ''
                  query_tags: {  }
              exposed_form:
                type: basic
                options:
                  submit_button: Apply
                  reset_button: false
                  reset_button_label: Reset
                  exposed_sorts_label: 'Sort by'
                  expose_sort_order: true
                  sort_asc_label: Asc
                  sort_desc_label: Desc
              pager:
                type: full
                options:
                  items_per_page: 9
                  offset: 0
                  id: 0
                  total_pages: null
                  tags:
                    previous: '‹ Previous'
                    next: 'Next ›'
                    first: '« First'
                    last: 'Last »'
                  expose:
                    items_per_page: false
                    items_per_page_label: 'Items per page'
                    items_per_page_options: '5, 10, 25, 50'
                    items_per_page_options_all: false
                    items_per_page_options_all_label: '- All -'
                    offset: false
                    offset_label: Offset
                  quantity: 9
              style:
                type: default
                options:
                  grouping: {  }
                  row_class: ''
                  default_row_class: true
              row:
                type: fields
                options:
                  inline: {  }
                  separator: ''
                  hide_empty: false
                  default_field_elements: true
              fields:
                thumbnail__target_id:
                  id: thumbnail__target_id
                  table: media_field_revision
                  field: thumbnail__target_id
                  relationship: none
                  group_type: group
                  admin_label: ''
                  label: ''
                  exclude: false
                  alter:
                    alter_text: false
                    text: ''
                    make_link: false
                    path: ''
                    absolute: false
                    external: false
                    replace_spaces: false
                    path_case: none
                    trim_whitespace: false
                    alt: ''
                    rel: ''
                    link_class: ''
                    prefix: ''
                    suffix: ''
                    target: ''
                    nl2br: false
                    max_length: 0
                    word_boundary: true
                    ellipsis: true
                    more_link: false
                    more_link_text: ''
                    more_link_path: ''
                    strip_tags: false
                    trim: false
                    preserve_tags: ''
                    html: false
                  element_type: ''
                  element_class: ''
                  element_label_type: ''
                  element_label_class: ''
                  element_label_colon: false
                  element_wrapper_type: ''
                  element_wrapper_class: ''
                  element_default_classes: true
                  empty: ''
                  hide_empty: false
                  empty_zero: false
                  hide_alter_empty: true
                  click_sort_column: target_id
                  type: image
                  settings:
                    image_style: media_library
                    image_link: ''
                  group_column: ''
                  group_columns: {  }
                  group_rows: true
                  delta_limit: 0
                  delta_offset: 0
                  delta_reversed: false
                  delta_first_last: false
                  multi_type: separator
                  separator: ', '
                  field_api_classes: false
                  entity_type: media
                  entity_field: thumbnail
                  plugin_id: field
                bundle:
                  id: bundle
                  table: media_field_data
                  field: bundle
                  relationship: none
                  group_type: group
                  admin_label: ''
                  label: ''
                  exclude: true
                  alter:
                    alter_text: false
                    text: ''
                    make_link: false
                    path: ''
                    absolute: false
                    external: false
                    replace_spaces: false
                    path_case: none
                    trim_whitespace: false
                    alt: ''
                    rel: ''
                    link_class: ''
                    prefix: ''
                    suffix: ''
                    target: ''
                    nl2br: false
                    max_length: 0
                    word_boundary: true
                    ellipsis: true
                    more_link: false
                    more_link_text: ''
                    more_link_path: ''
                    strip_tags: false
                    trim: false
                    preserve_tags: ''
                    html: false
                  element_type: ''
                  element_class: ''
                  element_label_type: ''
                  element_label_class: ''
                  element_label_colon: false
                  element_wrapper_type: ''
                  element_wrapper_class: ''
                  element_default_classes: true
                  empty: ''
                  hide_empty: false
                  empty_zero: false
                  hide_alter_empty: true
                  click_sort_column: target_id
                  type: entity_reference_label
                  settings:
                    link: false
                  group_column: target_id
                  group_columns: {  }
                  group_rows: true
                  delta_limit: 0
                  delta_offset: 0
                  delta_reversed: false
                  delta_first_last: false
                  multi_type: separator
                  separator: ', '
                  field_api_classes: false
                  entity_type: media
                  entity_field: bundle
                  plugin_id: field
                name:
                  id: name
                  table: media_field_data
                  field: name
                  relationship: none
                  group_type: group
                  admin_label: ''
                  label: ''
                  exclude: false
                  alter:
                    alter_text: true
                    text: "<div class=\"media-info\">\n<span class=\"media-info--{{ bundle }}\">{{ bundle }}</span>\n{{ name }}\n</div>"
                    make_link: false
                    path: ''
                    absolute: false
                    external: false
                    replace_spaces: false
                    path_case: none
                    trim_whitespace: false
                    alt: ''
                    rel: ''
                    link_class: ''
                    prefix: ''
                    suffix: ''
                    target: ''
                    nl2br: false
                    max_length: 0
                    word_boundary: false
                    ellipsis: false
                    more_link: false
                    more_link_text: ''
                    more_link_path: ''
                    strip_tags: false
                    trim: false
                    preserve_tags: ''
                    html: false
                  element_type: '0'
                  element_class: ''
                  element_label_type: ''
                  element_label_class: ''
                  element_label_colon: false
                  element_wrapper_type: ''
                  element_wrapper_class: ''
                  element_default_classes: true
                  empty: ''
                  hide_empty: false
                  empty_zero: false
                  hide_alter_empty: true
                  click_sort_column: value
                  type: string
                  settings:
                    link_to_entity: false
                  group_column: value
                  group_columns: {  }
                  group_rows: true
                  delta_limit: 0
                  delta_offset: 0
                  delta_reversed: false
                  delta_first_last: false
                  multi_type: separator
                  separator: ', '
                  field_api_classes: false
                  entity_type: media
                  entity_field: media
                  plugin_id: field
                entity_browser_select:
                  id: entity_browser_select
                  table: media
                  field: entity_browser_select
                  relationship: none
                  group_type: group
                  admin_label: ''
                  label: ''
                  exclude: false
                  alter:
                    alter_text: false
                    text: ''
                    make_link: false
                    path: ''
                    absolute: false
                    external: false
                    replace_spaces: false
                    path_case: none
                    trim_whitespace: false
                    alt: ''
                    rel: ''
                    link_class: ''
                    prefix: ''
                    suffix: ''
                    target: ''
                    nl2br: false
                    max_length: 0
                    word_boundary: true
                    ellipsis: true
                    more_link: false
                    more_link_text: ''
                    more_link_path: ''
                    strip_tags: false
                    trim: false
                    preserve_tags: ''
                    html: false
                  element_type: ''
                  element_class: ''
                  element_label_type: ''
                  element_label_class: ''
                  element_label_colon: false
                  element_wrapper_type: ''
                  element_wrapper_class: ''
                  element_default_classes: true
                  empty: ''
                  hide_empty: false
                  empty_zero: false
                  hide_alter_empty: true
                  entity_type: media
                  plugin_id: entity_browser_select
              filters:
                status:
                  id: status
                  table: media_field_data
                  field: status
                  relationship: none
                  group_type: group
                  admin_label: ''
                  operator: '='
                  value: '0'
                  group: 1
                  exposed: true
                  expose:
                    operator_id: ''
                    label: 'True'
                    description: null
                    use_operator: false
                    operator: status_op
                    identifier: status
                    required: true
                    remember: false
                    multiple: false
                    remember_roles:
                      authenticated: authenticated
                  is_grouped: true
                  group_info:
                    label: 'Publishing status'
                    description: ''
                    identifier: status
                    optional: true
                    widget: select
                    multiple: false
                    remember: false
                    default_group: All
                    default_group_multiple: {  }
                    group_items:
                      1:
                        title: Published
                        operator: '='
                        value: '1'
                      2:
                        title: Unpublished
                        operator: '='
                        value: '0'
                  entity_type: media
                  entity_field: status
                  plugin_id: boolean
                bundle:
                  id: bundle
                  table: media_field_data
                  field: bundle
                  relationship: none
                  group_type: group
                  admin_label: ''
                  operator: in
                  value: {  }
                  group: 1
                  exposed: true
                  expose:
                    operator_id: bundle_op
                    label: Provider
                    description: ''
                    use_operator: false
                    operator: bundle_op
                    identifier: provider
                    required: false
                    remember: false
                    multiple: false
                    remember_roles:
                      authenticated: authenticated
                      anonymous: '0'
                    reduce: false
                  is_grouped: false
                  group_info:
                    label: ''
                    description: ''
                    identifier: ''
                    optional: true
                    widget: select
                    multiple: false
                    remember: false
                    default_group: All
                    default_group_multiple: {  }
                    group_items: {  }
                  entity_type: media
                  entity_field: bundle
                  plugin_id: bundle
                name:
                  id: name
                  table: media_field_data
                  field: name
                  relationship: none
                  group_type: group
                  admin_label: ''
                  operator: contains
                  value: ''
                  group: 1
                  exposed: true
                  expose:
                    operator_id: name_op
                    label: 'Media name'
                    description: ''
                    use_operator: false
                    operator: name_op
                    identifier: name
                    required: false
                    remember: false
                    multiple: false
                    remember_roles:
                      authenticated: authenticated
                      anonymous: '0'
                  is_grouped: false
                  group_info:
                    label: ''
                    description: ''
                    identifier: ''
                    optional: true
                    widget: select
                    multiple: false
                    remember: false
                    default_group: All
                    default_group_multiple: {  }
                    group_items: {  }
                  entity_type: media
                  entity_field: name
                  plugin_id: string
                langcode:
                  id: langcode
                  table: media_field_data
                  field: langcode
                  relationship: none
                  group_type: group
                  admin_label: ''
                  operator: in
                  value: {  }
                  group: 1
                  exposed: true
                  expose:
                    operator_id: langcode_op
                    label: Language
                    description: ''
                    use_operator: false
                    operator: langcode_op
                    identifier: langcode
                    required: false
                    remember: false
                    multiple: false
                    remember_roles:
                      authenticated: authenticated
                      anonymous: '0'
                    reduce: false
                  is_grouped: false
                  group_info:
                    label: ''
                    description: ''
                    identifier: ''
                    optional: true
                    widget: select
                    multiple: false
                    remember: false
                    default_group: All
                    default_group_multiple: {  }
                    group_items: {  }
                  entity_type: media
                  entity_field: langcode
                  plugin_id: language
              sorts: {  }
              header: {  }
              footer: {  }
              empty: {  }
              relationships: {  }
              arguments: {  }
              display_extenders: {  }
              filter_groups:
                operator: AND
                groups:
                  1: AND
              css_class: view-media-entity-browser-view
              use_ajax: true
            cache_metadata:
              max-age: -1
              contexts:
                - 'languages:language_content'
                - 'languages:language_interface'
                - url
                - url.query_args
                - user.permissions
              tags: {  }
          media_browser_all:
            display_plugin: entity_browser
            id: media_browser_all
            display_title: 'Media browser'
            position: 1
            display_options:
              display_extenders: {  }
            cache_metadata:
              max-age: -1
              contexts:
                - 'languages:language_content'
                - 'languages:language_interface'
                - url
                - url.query_args
                - user.permissions
              tags: {  }
  